# MFToolkit.AutoGenerator - 自动注入源码生成器

## 概述

基于 Roslyn 源码生成器技术，在编译时自动扫描标记了注入特性的类，并生成对应的依赖注入代码。仅支持 .NET 9.0 及以上版本。

## 安装要求

```xml
<!-- 必须搭配 MFToolkit.Abstractions 使用 -->
<PackageReference Include="MFToolkit.AutoGenerator" Version="1.0.20" />
<PackageReference Include="MFToolkit.Abstractions" Version="1.0.20" />
```

## 生成结果示例

### 输入代码

```csharp
[Singleton<IMyService>]
public class MyService : IMyService { }

[Scoped<IRepository>("db1")]
public class Repository : IRepository { }
```

### 自动生成的代码

```csharp
// AutoGenerated/AutoInject.g.cs
public static partial class AutoInjectExtensions
{
    public static IServiceCollection AddAutoInjectServices(this IServiceCollection services)
    {
        // Singleton 服务注册
        services.AddSingleton<IMyService, MyService>();

        // Scoped 服务注册
        services.AddKeyedScoped<IRepository, Repository>("db1");

        return services;
    }
}
```

## 使用方法

### 1. 在 Startup 或 Program 中调用

```csharp
var builder = WebApplication.CreateBuilder(args);

// 调用自动生成的扩展方法
builder.Services.AddAutoInjectServices();

var app = builder.Build();
```

### 2. 使用自定义服务名称

```csharp
// 如果使用了 AutoInjectServiceName 特性
builder.Services.AddMyCustomServices(); // 自定义的方法名
```

## 支持的功能

- ✅ 多种生命周期（Singleton、Scoped、Transient）
- ✅ Keyed Services 支持
- ✅ TryAdd 模式防止重复注册
- ✅ 泛型服务注册
- ✅ 自定义扩展方法名称
- ✅ 命名空间分组生成

## 注意事项

- **编译时生成** - 生成的代码在编译时产生，不会污染源代码
- **性能优化** - 使用 Incremental Generator 技术，增量编译时只处理变化的代码